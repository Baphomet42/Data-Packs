tp @s ~ ~ ~ 0 0
execute at @s if block ^-1 ^-1 ^ quartz_block if block ^-1 ^ ^ quartz_block if block ^-1 ^1 ^ quartz_block if block ^ ^-1 ^ quartz_block if block ^ ^ ^ quartz_block if block ^ ^1 ^ quartz_block if block ^1 ^-1 ^ quartz_block if block ^1 ^ ^ quartz_block if block ^1 ^1 ^ quartz_block if block ^-1 ^-1 ^.2 #42:portal_bullet_pass if block ^-1 ^ ^.2 #42:portal_bullet_pass if block ^-1 ^1 ^.2 #42:portal_bullet_pass if block ^ ^-1 ^.2 #42:portal_bullet_pass if block ^ ^ ^.2 #42:portal_bullet_pass if block ^ ^1 ^.2 #42:portal_bullet_pass if block ^1 ^-1 ^.2 #42:portal_bullet_pass if block ^1 ^ ^.2 #42:portal_bullet_pass if block ^1 ^1 ^.2 #42:portal_bullet_pass run tag @s add 42.portal_s
tp @s ~ ~ ~ 90 0
execute at @s unless entity @s[tag=42.portal_s] if block ^-1 ^-1 ^ quartz_block if block ^-1 ^ ^ quartz_block if block ^-1 ^1 ^ quartz_block if block ^ ^-1 ^ quartz_block if block ^ ^ ^ quartz_block if block ^ ^1 ^ quartz_block if block ^1 ^-1 ^ quartz_block if block ^1 ^ ^ quartz_block if block ^1 ^1 ^ quartz_block if block ^-1 ^-1 ^.2 #42:portal_bullet_pass if block ^-1 ^ ^.2 #42:portal_bullet_pass if block ^-1 ^1 ^.2 #42:portal_bullet_pass if block ^ ^-1 ^.2 #42:portal_bullet_pass if block ^ ^ ^.2 #42:portal_bullet_pass if block ^ ^1 ^.2 #42:portal_bullet_pass if block ^1 ^-1 ^.2 #42:portal_bullet_pass if block ^1 ^ ^.2 #42:portal_bullet_pass if block ^1 ^1 ^.2 #42:portal_bullet_pass run tag @s add 42.portal_w
tp @s ~ ~ ~ 180 0
execute at @s unless entity @s[tag=42.portal_s] unless entity @s[tag=42.portal_w] if block ^-1 ^-1 ^ quartz_block if block ^-1 ^ ^ quartz_block if block ^-1 ^1 ^ quartz_block if block ^ ^-1 ^ quartz_block if block ^ ^ ^ quartz_block if block ^ ^1 ^ quartz_block if block ^1 ^-1 ^ quartz_block if block ^1 ^ ^ quartz_block if block ^1 ^1 ^ quartz_block if block ^-1 ^-1 ^.2 #42:portal_bullet_pass if block ^-1 ^ ^.2 #42:portal_bullet_pass if block ^-1 ^1 ^.2 #42:portal_bullet_pass if block ^ ^-1 ^.2 #42:portal_bullet_pass if block ^ ^ ^.2 #42:portal_bullet_pass if block ^ ^1 ^.2 #42:portal_bullet_pass if block ^1 ^-1 ^.2 #42:portal_bullet_pass if block ^1 ^ ^.2 #42:portal_bullet_pass if block ^1 ^1 ^.2 #42:portal_bullet_pass run tag @s add 42.portal_n
tp @s ~ ~ ~ -90 0
execute at @s unless entity @s[tag=42.portal_s] unless entity @s[tag=42.portal_w] unless entity @s[tag=42.portal_n] if block ^-1 ^-1 ^ quartz_block if block ^-1 ^ ^ quartz_block if block ^-1 ^1 ^ quartz_block if block ^ ^-1 ^ quartz_block if block ^ ^ ^ quartz_block if block ^ ^1 ^ quartz_block if block ^1 ^-1 ^ quartz_block if block ^1 ^ ^ quartz_block if block ^1 ^1 ^ quartz_block if block ^-1 ^-1 ^.2 #42:portal_bullet_pass if block ^-1 ^ ^.2 #42:portal_bullet_pass if block ^-1 ^1 ^.2 #42:portal_bullet_pass if block ^ ^-1 ^.2 #42:portal_bullet_pass if block ^ ^ ^.2 #42:portal_bullet_pass if block ^ ^1 ^.2 #42:portal_bullet_pass if block ^1 ^-1 ^.2 #42:portal_bullet_pass if block ^1 ^ ^.2 #42:portal_bullet_pass if block ^1 ^1 ^.2 #42:portal_bullet_pass run tag @s add 42.portal_e
tp @s ~ ~ ~ 0 -90
execute at @s unless entity @s[tag=42.portal_s] unless entity @s[tag=42.portal_w] unless entity @s[tag=42.portal_n] unless entity @s[tag=42.portal_e] if block ^-1 ^-1 ^ quartz_block if block ^-1 ^ ^ quartz_block if block ^-1 ^1 ^ quartz_block if block ^ ^-1 ^ quartz_block if block ^ ^ ^ quartz_block if block ^ ^1 ^ quartz_block if block ^1 ^-1 ^ quartz_block if block ^1 ^ ^ quartz_block if block ^1 ^1 ^ quartz_block if block ^-1 ^-1 ^.2 #42:portal_bullet_pass if block ^-1 ^ ^.2 #42:portal_bullet_pass if block ^-1 ^1 ^.2 #42:portal_bullet_pass if block ^ ^-1 ^.2 #42:portal_bullet_pass if block ^ ^ ^.2 #42:portal_bullet_pass if block ^ ^1 ^.2 #42:portal_bullet_pass if block ^1 ^-1 ^.2 #42:portal_bullet_pass if block ^1 ^ ^.2 #42:portal_bullet_pass if block ^1 ^1 ^.2 #42:portal_bullet_pass run tag @s add 42.portal_floor
tp @s ~ ~ ~ 0 90
execute at @s unless entity @s[tag=42.portal_s] unless entity @s[tag=42.portal_w] unless entity @s[tag=42.portal_n] unless entity @s[tag=42.portal_e] unless entity @s[tag=42.portal_floor] if block ^-1 ^-1 ^ quartz_block if block ^-1 ^ ^ quartz_block if block ^-1 ^1 ^ quartz_block if block ^ ^-1 ^ quartz_block if block ^ ^ ^ quartz_block if block ^ ^1 ^ quartz_block if block ^1 ^-1 ^ quartz_block if block ^1 ^ ^ quartz_block if block ^1 ^1 ^ quartz_block if block ^-1 ^-1 ^.2 #42:portal_bullet_pass if block ^-1 ^ ^.2 #42:portal_bullet_pass if block ^-1 ^1 ^.2 #42:portal_bullet_pass if block ^ ^-1 ^.2 #42:portal_bullet_pass if block ^ ^ ^.2 #42:portal_bullet_pass if block ^ ^1 ^.2 #42:portal_bullet_pass if block ^1 ^-1 ^.2 #42:portal_bullet_pass if block ^1 ^ ^.2 #42:portal_bullet_pass if block ^1 ^1 ^.2 #42:portal_bullet_pass run tag @s add 42.portal_ceiling
execute if entity @s[tag=42.portal_gun_blue] unless entity @s[tag=!42.portal_s,tag=!42.portal_w,tag=!42.portal_n,tag=!42.portal_e,tag=!42.portal_floor,tag=!42.portal_ceiling] at @s align xyz positioned ~.5 ~ ~.5 run function 42:portal/portal/spawn_blue
execute if entity @s[tag=42.portal_gun_orange] unless entity @s[tag=!42.portal_s,tag=!42.portal_w,tag=!42.portal_n,tag=!42.portal_e,tag=!42.portal_floor,tag=!42.portal_ceiling] at @s align xyz positioned ~.5 ~ ~.5 run function 42:portal/portal/spawn_orange
kill @s[type=marker]